{# Formulario artículos en promoción #}

{% extends popup %}

{% block content %}
    {% include "_global/alertas.html.twig" with {'alertas': values.alertas,'errores': values.errores} %}

    {% block listado %}
        <div class="row">
            <div class="col-md-12 text-center">
                <table class="table table-hover table-bordered table-striped">
                    <thead>
                        <tr>
                            <th class="text-center">Código</th>
                            <th class="text-center">Clientes</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for keyLinea,linea in values.clientes %}
                        <form name="formLinea{{keyLinea}}" id="formLinea{{keyLinea}}" method="post">
                            <input type="hidden" name="controller" value="Promociones"/>
                            <input type="hidden" name="action" id="action{{keyLinea}}" value=""/>
                            <input type="hidden" name="accion" id="accion{{keyLinea}}" value=""/>
                            <input type="hidden" name="idPromocion" value="{{values.idPromocion}}"/>
                            <input type="hidden" name="Relaciones[Id]" id="Relaciones{{keyLinea}}" value="{{linea.Id}}"/>
                            <tr>
                                <td>
                                    <input type="hidden" id="codigo{{keyLinea}}" value="{{linea.IdArticulo.Codigo}}"/>
                                    <input type="hidden" name="Promociones[IdArticulo]" id="IdArticulo{{keyLinea}}" value="{{linea.IdArticulo.Id}}"/>
                                    <input class="form-control" style="width: 90px;" autocomplete="off" spellcheck="false" type="text" id="Codigo{{keyLinea}}" value="{{linea.IdArticulo.Codigo}}"
                                           onkeyup="autoCompleteArticulo('{{keyLinea}}', '{{values.idFirma}}', '{{values.idFamilia}}');" onblur="$(this).val($('#codigo{{keyLinea}}').val());"/> 
                                </td>                                
                                <td><input class="form-control input-medium" type="text" name="Relaciones[IdEntidadDestino]" id="Descripcion{{keyLinea}}" value="{{linea.IdEntidadDestino.RazonSocial}}"/></td>
                                <td>
                                    <div  id="botonera{{keyLinea}}">
                                        {% if linea.Id %}
                                            <button class="btn primary" style="float:left; margin-right: 0px !important;" onclick="return guardar({{keyLinea}});"><i class="fa fa-save"></i></button>
                                            <button class="btn primary" style="float:left; margin-right: 0px !important;" onclick="borrar({{keyLinea}});"><i class="fa fa-trash"></i></button>
                                            <button class="btn primary" style="float:left; margin-right: 0px !important;" onclick="return showClientes({{keyLinea}});" title="Ver Clientes"><i class="fa fa-angle-double-right"></i></button>                                            
                                            {% else %}
                                            <button class="btn primary" style="float:left; margin-right: 0px !important;" onclick="return crear({{keyLinea}});"><i class="fa fa-save"></i></button>                                
                                            {% endif %}
                                    </div>
                                    <div id="espere{{keyLinea}}" class="hidden text-center"><img src="/assets/global/img/loading-spinner-blue.gif"/></div>
                                </td>
                            </tr>
                        </form>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>        
    {% endblock %}

{% endblock %}